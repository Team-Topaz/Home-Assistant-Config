- id: tv_away_off
  alias: 'Media Center: Turn off when away'
  trigger:
  - platform: state
    entity_id: group.all_devices
    to: not_home
  condition:
  - condition: state
    entity_id: remote.living_room
    state: 'on'
  action:
    service: remote.turn_off
    entity_id: remote.living_room
    
- id: tv_midnight_off
  alias: 'Media Center: Turn off when past midnight'
  trigger:
  - platform: time
    at: '00:00:00'
  condition:
  - condition: state
    entity_id: remote.living_room
    state: 'on'
  action:
    service: remote.turn_off
    entity_id: remote.living_room
    
#Turn off the TV if the Harmony messed up.
- id: tv_harmony_error_off
  alias: "Media Center: Turn off TV if it is erroneously on"
  #Disabled for now because I can't get the harmony to turn the damned thing off.
  initial_state: False
  trigger:
  - platform: time
    minutes: '/5'
    seconds: 00
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: binary_sensor.living_room_tv
        state: 'on'
      - condition: state
        entity_id: remote.living_room
        state: 'off'
  action:
    #We delay before taking action because the binary sensor can take some time to register a correct status.
    - delay: 1:00
    - condition: state
      entity_id: binary_sensor.living_room_tv
      state: 'on'
    - service: notify.push_main
      data:
        message: "Hey, the TV is on and it shouldn't be!"
    - service: remote.send_command
      data:
        entity_id: remote.living_room
        command: TurnOff
        device: 44569912