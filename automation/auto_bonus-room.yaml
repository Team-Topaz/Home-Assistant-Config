### LIGHT ###

- id: bonus_room_light_motion_on
  alias: 'Bonus Room Light: Turn On When Motion'
  trigger:
  - platform: state
    entity_id: binary_sensor.bonus_room_motion
    to: 'on'
  condition:
  - condition: state
    entity_id: group.all_devices
    state: 'home'
  action:
    - service: light.turn_on
      data:
        entity_id: light.bonus_room_fan_light

- id: bonus_room_light_motion_off
  alias: 'Bonus Room Light: Turn Off When No motion'
  trigger:
  - platform: state
    entity_id: binary_sensor.bonus_room_motion
    to: 'off'
    for:
      minutes: 10
  - platform: state
    entity_id: light.bonus_room_fan_light
    to: 'on'
    for:
      minutes: 10
  condition:
    condition: state
    entity_id: binary_sensor.bonus_room_motion
    state: 'off'
    for:
      minutes: 10
  action:
    - service: light.turn_off
      data:
        entity_id: light.bonus_room_fan_light

### FAN ###

- id: bonus_room_enable_autofan_when_motion
  alias: 'Bonus Room Fan: Turn On When Motion'
  trigger:
  - platform: state
    entity_id: binary_sensor.bonus_room_motion
    to: 'on'
  condition:
  - condition: state
    entity_id: group.all_devices
    state: 'home'
  - condition: state
    entity_id: climate.bonus_room_fan
    state: 'off'
  action:
    - service: script.turn_on
      entity_id: script.bonus_room_restore_fan_state

- id: bonus_room_disable_autofan_when_away
  alias: 'Bonus Room Fan: Disable autofan when away'
  trigger:
  - platform: state
    entity_id: group.all_devices
    to: not_home
    for:
      minutes: 5
  - platform: state
    entity_id: binary_sensor.bonus_room_motion
    to: 'off'
    for:
      minutes: 10
  condition:
    condition: state
    entity_id: binary_sensor.bonus_room_motion
    state: 'off'
    for:
      minutes: 10
  action:
    - service: script.turn_on
      entity_id: script.bonus_room_save_fan_state
    - service: climate.set_operation_mode
      data:
        entity_id: climate.bonus_room_fan
        operation_mode: 'off'
