#These turn on and off the living room fan climate component as needed.
#They're designed to trigger ONLY when the temperature crosses the threshold.
#This is to allow user control if they want the fan to stay off.
- id: fan_on_when_hot
  alias: 'Living Room: Turn Fan On When Hot'
  trigger:
  - platform: homeassistant
    event: start
  - platform: numeric_state
    entity_id: sensor.living_room_outdoor_temperature_delta
    above: 0
  - platform: template
    value_template: '{{ (states.living_room_fan_setpoint.state | float) < (states.outdoor_temperature.state | float) }}'
  condition:
  - condition: and
    conditions:
    - condition: numeric_state
      entity_id: sensor.living_room_outdoor_temperature_delta
      above: 0
    - condition: template
      value_template: '{{ (states.living_room_fan_setpoint.state | float) < (states.outdoor_temperature.state | float) }}'
  action:
  - service: climate.set_operation_mode
    data:
      entity_id: climate.living_room_fan
      operation_mode: 'cool'

- id: fan_off_when_hotter_outside
  alias: 'Living Room: Turn Fan Off When Hotter Outside'
  trigger:
  - platform: homeassistant
    event: start
  - platform: numeric_state
    entity_id: sensor.living_room_outdoor_temperature_delta
    below: 0
  condition:
  - condition: numeric_state
    entity_id: sensor.living_room_outdoor_temperature_delta
    below: 0
  action:
  - service: climate.set_operation_mode
    data:
      entity_id: climate.living_room_fan
      operation_mode: 'off'
